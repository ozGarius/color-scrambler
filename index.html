<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color Scrambler</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800&display=swap" rel="stylesheet">
</head>

<body>
    <div class="app-wrapper">
        <!-- Sidebar: Controls & Settings -->
        <aside class="sidebar" id="sidebar">
            <header>
                <h1>ðŸŽ¨ Color Scrambler</h1>
                <button class="theme-toggle" id="themeToggle">
                    <span id="themeIcon">ðŸŒ™</span>
                    <span id="themeText">Dark Mode</span>
                </button>
            </header>

            <div class="controls-scroll">
                <!-- Section 1: Upload (Static) -->
                <div class="control-group">
                    <label>1. Upload Image</label>
                    <input type="file" id="fileInput" accept="image/*">
                </div>

                <!-- Reorderable Pipeline -->
                <div id="effectPipeline" style="display: flex; flex-direction: column; gap: 12px;">
                    <!-- Module: Pixel Scramble -->
                    <div class="control-group draggable" data-effect="scramble">
                        <div class="control-group-header">
                            <label>Pixel Scramble</label>
                            <div class="drag-handle" title="Drag to reorder"></div>
                        </div>
                        <div class="checkbox-group">
                            <label class="checkbox-option">
                                <input type="checkbox" id="scrambleHue" checked>
                                <span>Scramble Hue</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox" id="scrambleSaturation" checked>
                                <span>Scramble Saturation</span>
                            </label>
                        </div>
                        <div class="radio-group" style="margin-top: 8px; gap: 5px;">
                            <select id="scrambleMode">
                                <option value="random">Random Mode</option>
                                <option value="consistent" selected>Consistent Mode</option>
                            </select>
                            <select id="brightnessMode">
                                <option value="hsv">HSV Brightness</option>
                                <option value="luminance" selected>Human Luminance</option>
                            </select>
                        </div>
                    </div>

                    <!-- Module: Channel Swap -->
                    <div class="control-group draggable" data-effect="channelSwap">
                        <div class="control-group-header">
                            <label>Channel Swap</label>
                            <div class="drag-handle" title="Drag to reorder"></div>
                        </div>
                        <select id="channelSwap">
                            <option value="none" selected>None (RGB)</option>
                            <option value="rbg">RBG</option>
                            <option value="grb">GRB</option>
                            <option value="gbr">GBR</option>
                            <option value="brg">BRG</option>
                            <option value="bgr">BGR</option>
                        </select>
                    </div>

                    <!-- Module: Pixel Sorting -->
                    <div class="control-group draggable" data-effect="pixelSort">
                        <div class="control-group-header">
                            <label>Pixel Sorting</label>
                            <div class="drag-handle" title="Drag to reorder"></div>
                        </div>
                        <label class="checkbox-option">
                            <input type="checkbox" id="pixelSort">
                            <span>Enable Sorting</span>
                        </label>
                        <div id="sortControls"
                            style="display: none; margin-top: 5px; padding-left: 10px; border-left: 2px solid var(--primary);">
                            <div style="display: flex; flex-direction: column; gap: 5px;">
                                <select id="sortDirection">
                                    <option value="horizontal" selected>Horizontal</option>
                                    <option value="vertical">Vertical</option>
                                </select>
                                <select id="sortCriteria">
                                    <option value="brightness" selected>Brightness</option>
                                    <option value="hue">Hue</option>
                                    <option value="saturation">Saturation</option>
                                </select>
                                <input type="range" id="sortThreshold" min="0" max="255" value="100">
                                <label class="checkbox-option" style="font-size: 0.75rem;">
                                    <input type="checkbox" id="sortReverse">
                                    <span>Reverse Order</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Module: Chromatic Aberration -->
                    <div class="control-group draggable" data-effect="ca">
                        <div class="control-group-header">
                            <label>Chromatic Aberration</label>
                            <div class="drag-handle" title="Drag to reorder"></div>
                        </div>
                        <label class="checkbox-option">
                            <input type="checkbox" id="enableCA">
                            <span>Enable RGB Split</span>
                        </label>
                        <div id="caControls"
                            style="display: none; margin-top: 5px; padding-left: 10px; border-left: 2px solid var(--primary);">
                            <label style="font-size: 0.7rem;">Intensity:</label>
                            <input type="range" id="caIntensity" min="1" max="50" value="10" style="width: 100%;">
                        </div>
                    </div>

                    <!-- Module: Dither & Retro -->
                    <div class="control-group draggable" data-effect="dither">
                        <div class="control-group-header">
                            <label>Dither & Retro</label>
                            <div class="drag-handle" title="Drag to reorder"></div>
                        </div>
                        <label class="checkbox-option">
                            <input type="checkbox" id="enableDither">
                            <span>Enable Dithering</span>
                        </label>
                        <div id="ditherControls"
                            style="display: none; margin-top: 5px; padding-left: 10px; border-left: 2px solid var(--primary);">
                            <div style="display: flex; flex-direction: column; gap: 5px;">
                                <label style="font-size: 0.7rem;">Color Depth:</label>
                                <select id="ditherDepth">
                                    <option value="2">Low (2 levels)</option>
                                    <option value="4" selected>Medium (4 levels)</option>
                                    <option value="8">High (8 levels)</option>
                                </select>
                                <label style="font-size: 0.7rem;">Pixel Size:</label>
                                <input type="range" id="ditherScale" min="1" max="10" value="1" style="width: 100%;">
                            </div>
                        </div>
                    </div>

                    <!-- Module: Stained Glass -->
                    <div class="control-group draggable" data-effect="voronoi">
                        <div class="control-group-header">
                            <label>Stained Glass</label>
                            <div class="drag-handle" title="Drag to reorder"></div>
                        </div>
                        <label class="checkbox-option">
                            <input type="checkbox" id="enableVoronoi">
                            <span>Enable Mosaic</span>
                        </label>
                        <div id="voronoiControls"
                            style="display: none; margin-top: 5px; padding-left: 10px; border-left: 2px solid var(--primary);">
                            <label style="font-size: 0.7rem;">Cell Count:</label>
                            <input type="range" id="voronoiCells" min="50" max="5000" value="500" style="width: 100%;">
                        </div>
                    </div>
                </div>
            </div>

            <div class="actions-container">
                <button class="process-btn" id="processBtn" disabled>âœ¨ Process Image</button>
                <div class="button-group">
                    <button class="download-btn" id="downloadBtn" disabled>ðŸ“¥ Download</button>
                    <button class="secondary-btn" id="resetBtn">ðŸ”„ Reset</button>
                </div>
                <div class="button-group">
                    <button class="secondary-btn" id="saveBtn">ðŸ’¾ Save Config</button>
                    <button class="secondary-btn" id="loadBtn">ðŸ“‚ Load Config</button>
                </div>
            </div>
        </aside>

        <!-- Resizer Divider -->
        <div class="resizer" id="resizer"></div>

        <!-- Main Content: Image Previews -->
        <main class="main-content">
            <div class="images-layout">
                <div class="image-box">
                    <h3>Original</h3>
                    <div class="image-wrapper">
                        <canvas id="originalCanvas"></canvas>
                        <div class="placeholder" id="originalPlaceholder">Waiting for image...</div>
                    </div>
                </div>
                <div class="image-box">
                    <h3>Scrambled</h3>
                    <div class="image-wrapper">
                        <canvas id="resultCanvas"></canvas>
                        <div class="placeholder" id="resultPlaceholder">Results will appear here</div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="script.js" defer></script>
</body>

</html>